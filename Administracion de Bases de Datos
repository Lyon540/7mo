Create database Tren
Use Tren

Create table Pasajero(
Id_Pasajero Int,
Nombre Varchar (20),
APaterno Varchar (20),
AMaterno Varchar (20),
Email Varchar (60),
FechaNac Datetime,
Telefono Varchar (60),
Id_Pais int
)

/*Ejercicio 2*/
Create clustered index indice_Id_Pasajero
On Pasajero (Id_Pasajero)

/*Ejercicio 3*/
Create NonClustered index indice_APaterno_AMaterno
On Pasajero (APaterno, AMaterno)

/*Ejercicio 4*/
Create NonClustered index indice_Id_Pais
On Pasajero (Id_Pais)

/*Ejercicio 5*/
Create NonClustered index indice_Email
On Pasajero (Email)

/*Ejercicio 6*/
Create NonClustered index indice_FechaNac
On Pasajero (FechaNac)

/*Ejercicio 7*/
Create NonClustered index Indice_APaterno_AMaterno On Pasajero(Nombre)
With drop_existing

/*Ejercicio 8*/
Create Clustered index Indice_Id_Pais On Pasajero(Nombre)
With drop_existing

/*Ejercicio 9*/
Drop Index Pasajero.indice_Email

/*Ejercicio 10*/
SP_Helpindex Pasajero

Practica 4

Create database Empresa
Use Empresa

Create table Venta(
Codigo_Venta int Primary Key,
No_Vendedor int,
Codigo_Producto int,
Fecha Date
)

Insert into Venta Values(1,124,23,'08/23/2015')
Insert into Venta Values(3,643,42,'08/23/2015')
Insert into Venta Values(5,124,23,'08/25/2015')
Insert into Venta Values(6,642,45,'08/25/2015')

Create table Vendedor(
No_Vendedor int Primary Key,
Nombre Varchar (60),
Apellido varchar (40),
Edad int,
Genero varchar (1),
Sueldo Money
)

Insert into Vendedor Values(124,'Gregorio','Arredondo',34,'M','9000')
Insert into Vendedor Values(34,'Alberto','Luna',20,'M','8500')
Insert into Vendedor Values(642,'Julio','Mandujando',45,'M','9500')
Insert into Vendedor Values(145,'Fernando','Cortes',31,'M', '8500')
Insert into Vendedor Values(643,'Veronica','Sepulveda',19,'F','8500')

Create Proc Ejercicio1
As Select Venta.Codigo_Venta,Venta.No_Vendedor,Vendedor.Nombre,Vendedor.Apellido, Vendedor.No_Vendedor from Venta
inner Join Vendedor
On Venta.No_Vendedor = Vendedor.No_Vendedor
Order by Apellido
Execute Ejercicio1

Create Proc Ejercicio2
As Select Venta.Codigo_Venta, Vendedor.Nombre,Vendedor.Apellido, Vendedor.Sueldo From Venta
Inner Join Vendedor
On Venta.No_Vendedor=Vendedor.No_Vendedor
Where Genero ='M'
Execute Ejercicio2

Create Proc Ejercicio3
As Select Venta.Codigo_Venta, Venta.No_Vendedor, Venta.Codigo_Producto, Venta.Fecha, Vendedor.Nombre,Vendedor.Apellido From Venta
Inner Join Vendedor
On Venta.No_Vendedor=Vendedor.No_Vendedor
Where Codigo_Producto between 20 and 40
Execute Ejercicio3

Create Proc Ejercicio4
As Select Nombre,Apellido,sueldo+500 from Vendedor
Where Sueldo = 8500
Execute Ejercicio4

Create Proc Ejercicio5
As Select Genero, AVG (Sueldo) as 'Salaro Promedio' from Vendedor
Group by Genero
Execute Ejercicio5

Alter Proc Ejercicio5
As  Select Genero, AVG (Sueldo) as 'Salaro Promedio' from Vendedor
Where Apellido not like '%s'
Group by Genero
Execute Ejercicio5

Execute Ejercicio5
Execute Ejercicio4
Execute Ejercicio3
Execute Ejercicio2
Execute Ejercicio1

Sp_Helptext Ejercicio5

Drop Proc Ejercicio4

Practica 5

Create Database Empresa
use Empresa

Create table Empleado_Laboral (
No_Empleado int Primary Key,
Especialidad Varchar (60),
Fecha_Alta Date,
Titulo Varchar (2),
Salario Money,
Departamento Varchar (60)
)

Create proc Ejercicio1
@No_Empleado  int,
@Especialidad Varchar (60),
@Fecha_Alta   Date,
@Titulo       Varchar (2),
@Salario      Money,
@Departamento Varchar (50)
As
Insert into Empleado_Laboral (No_Empleado,Especialidad,Fecha_Alta,Titulo,Salario,Departamento)
Values (@No_Empleado,@Especialidad,@Fecha_Alta,@Titulo,@Salario,@Departamento)

Execute Ejercicio1 @No_Empleado  = 100,
                   @Especialidad = 'Contabilidad',
				   @Fecha_Alta   = '02/05/2001',
				   @Titulo       = 'Si',
				   @Salario      = '8000',
				   @Departamento = 'Finanzas'

Execute Ejercicio1 @No_Empleado  = 101,
                   @Especialidad = 'Ingenieria',
				   @Fecha_Alta   = '02/08/2007',
				   @Titulo       = 'Si',
				   @Salario      = '10000',
				   @Departamento = 'Soporte'

Execute Ejercicio1 @No_Empleado  = 102,
                   @Especialidad = 'Licenciatura',
				   @Fecha_Alta   = '02/08/2001',
				   @Titulo       = 'Si',
				   @Salario      = '10000',
				   @Departamento = 'Proyectos'

Execute Ejercicio1 @No_Empleado  = 103,
                   @Especialidad = 'Servicio Social',
				   @Fecha_Alta   = '02/05/2001',
				   @Titulo       = 'Si',
				   @Salario      = '9000',
				   @Departamento = 'Calidad'

Execute Ejercicio1 @No_Empleado  = 104,
                   @Especialidad = 'Quimica',
				   @Fecha_Alta   = '02/05/2001',
				   @Titulo       = 'Si',
				   @Salario      = '12000',
				   @Departamento = 'Produccion'
           
Create Proc Ejercicio3
@Especialidad Varchar (60) As
Select No_Empleado, Titulo from Empleado_Laboral
Where Especialidad=@Especialidad
Execute Ejercicio3 'Licenciatura'

Create Proc Ejercicio4
@No_Empleado int, @Departamento Varchar(50) As
Select * from Empleado_Laboral
Where No_Empleado=@No_Empleado and Departamento=@Departamento
Execute Ejercicio4 100,'Finanzas'

Create Proc Ejercicio5
@Fecha_Alta date, @Salario Money As
Select * from Empleado_Laboral
Where Fecha_Alta = @Fecha_Alta or Salario = @Salario
Execute Ejercicio5 '02/05/2001','9000'

Create Procedure Ejercicio6
@No_Empleado Int,
@Salario Money  As
Update Empleado_Laboral set Salario = @Salario
Where No_Empleado = @No_Empleado 
Execute Ejercicio6 100,12000

Create Procedure Ejercicio7
@No_Empleado int,
@Departamento varchar (60),
@Salario Money  As
Update Empleado_Laboral set Departamento = @Departamento, Salario = @Salario
Where No_Empleado = @No_Empleado or Departamento = @Departamento And Salario = @Salario
Execute Ejercicio7 '103','Finanzas','8000'

Create Procedure Ejercicio8
@Titulo Varchar (2) As
Delete from Empleado_Laboral
Where Titulo=@Titulo

Exec Ejercicio8 'No' 

Segundo Parcial
Practica1

Create proc Ejemplo1
@N1 int,
@N2 int,
@Suma int Output As
Select @Suma=@N1+@N2

Declare @Resultado int
Exec Ejemplo1 10, 20, @Resultado Output
Select @Resultado As Suma

Practica 1.1

Create Database Ejercicio_Clase
Use Ejercicio_Clase

Create Table Ejemplo(
Matricula Int,
Nombre Varchar (100),
Carrera Varchar (10),
Sexo Varchar (1),
Edad int
)

Insert Into Ejemplo Values(184310,'Patricia Vidal Garza', 'LSCA', 'F', 24)
Insert Into Ejemplo Values(164920,'Ramiro Perez Lopez', 'IMA', 'M', 17)
Insert Into Ejemplo Values(199879,'Francisco Gonzalez Lopez', 'IAS', 'M', 20)

Create Proc Ejemplo2
@Cantidad Int Output,
@Sexo Varchar (1),
@Edad Int As
Select @Cantidad=(Select Count (Matricula) From Ejemplo
Where Sexo=@Sexo And Edad>=@Edad)

Declare @Resultado int
Exec Ejemplo2 @Resultado Output, 'M',18
Select @Resultado

Practica 2

Create database UMM
Use UMM

Create table Cursos (
Id_Curso         Int Primary Key,
Nombre           Varchar (40),
Id_Categoria     Int,
Costo            Float,
Fecha_Disponible Datetime,
Duracion         Float,
Presencial       Varchar (30)
)

Insert into Cursos Values (1, 'Base de Datos', 2, '560', '02/01/1999', '90', 'Si')
Insert into Cursos Values (2, 'Lenguaje C', 1, '1900', '07/01/2000', '120', 'Si')
Insert into Cursos Values (3, 'Fotografia', 4, '900', '03/01/1999', '40', 'No')
Insert into Cursos Values (4, 'Repostreria', 3, '500', '03/01/1999', '5', 'Si')
Insert into Cursos Values (5, 'SQL', 1, '1500', '07/01/2000', '120', 'Si')

Create table Categorias (
Id_Categoria Int Primary Key,
Categoria    Varchar (30)
)

Insert into Categorias Values (1, 'Programacion')
Insert into Categorias Values (2, 'BD')
Insert into Categorias Values (3, 'Cocina')
Insert into Categorias Values (4, 'Fotografia')

Create table Alumnos (
Matricula        Int Primary Key,
Apellidos        Varchar (40),
Nombre           Varchar (40),
Sexo             Varchar (15),
Fecha_Nacimiento Datetime
)

Insert into Alumnos Values (123766, 'Garcia Gonzalez', 'Raul', 'M', '09/23/1984')
Insert into Alumnos Values (152442, 'Hurtado Flores', 'Patricia', 'F', '04/17/1990')
Insert into Alumnos Values (123654, 'Diaz Lopez', 'Diana', 'F', '04/30/1986')
Insert into Alumnos Values (145242, 'Acosta Sanchez', 'Federico', 'M', '02/25/1991')
Insert into Alumnos Values (109584, 'Contreras Castillo', 'Angel', 'M', '06/20/1987')

Create table Alumnos_por_Curso(
Matricula    int,
Id_Curso     int,
AÃ±o          int,
Calificacion Float
)

Insert into Alumnos_por_Curso Values (123766, 1, 2013, '8.7')
Insert into Alumnos_por_Curso Values (185858, 7, 2010, '9.8')
Insert into Alumnos_por_Curso Values (190944, 3, 2014, '10')
Insert into Alumnos_por_Curso Values (145242, 2, 2013, '7.5')
Insert into Alumnos_por_Curso Values (109584, 1, 2013, '8.7')

/*Ejercicio 2*/
Create View AlumnosVista
As
Select Alumnos_por_Curso.Matricula, Alumnos_por_Curso.Id_Curso, Alumnos_por_Curso.Calificacion, Cursos.Nombre from Alumnos_por_Curso
Inner Join Cursos
On Alumnos_por_Curso.Id_Curso = Cursos.Id_Curso
/*Ejetcicio 3*/
Select* from AlumnosVista

Select * From AlumnosVista
Where Nombre = 'Base de Datos'

Select * From AlumnosVista
Where Calificacion > '8'

Alter view AlumnosVista 
As
Select Alumnos_por_Curso.Matricula, Alumnos_por_Curso.Id_Curso, Alumnos_por_Curso.Calificacion, Cursos.Nombre, Cursos.Presencial from Alumnos_por_Curso
Inner Join Cursos
On Alumnos_por_Curso.Id_Curso = Cursos.Id_Curso

Select* from AlumnosVista


Drop View AlumnosVista

Practica 3

create database Autobus
Use Autobus

Create table Ciudades (
Codigo_Ciudad TinyInt Identity Primary Key,
Nombre        Varchar(30)
)

Create table Clientes(
Codigo    Int Primary Key,
Nombre    Varchar(30),
Domicilio Varchar (40),
CodCiudad Int
)

Insert into Clientes Values(1, 'Juan Perez', 'Colon 1123', 1)
Insert into Clientes Values(3, 'Karina Lopez', 'San Martin 254', 2)
Insert into Clientes Values(4, 'Luis Garcia', 'Juarez 345', 1)
Insert into Clientes Values(6, 'Marcos Gonzalez', 'G. Sada 458', 3)
Insert into Clientes Values(7, 'Nora Torres', 'Mar Rojo 567', 1)
Insert into Clientes Values(8, 'Oscar Tamez', 'San Martin 786', 4)

Create table Nombre (
Monterrey Varchar (30),
Santa_Catarina Varchar (30),
San_Pedro Varchar (30),
Guadalupe Varchar (30)
)

Practica 4

Create database UMM
Use UMM

Create table Alumno (
Matricula    int Primary Key,
Nombre       Varchar (30),
Carrera      Varchar (50),
FechaIngreso Date,
Telefono     Varchar (20)
)

/*Ejercicio 1*/
Create Trigger Ejercicio1
On Alumno 
For Insert As
Print 'Se ingreso un Registro'

/*Ejercicio 2*/
Insert into Alumno Values(147852,'Luis Guerrero','Lic. en Sistemas','05/07/2014','88808572')

/*Ejercicio 3*/
Alter Table Alumno
Disable Trigger Ejercicio1

/*Ejercicio 4*/
Create Trigger Ejercicio2
On Alumno 
For After As
Print 'Se ingreso un Registro'

/*Ejercicio 5*/
Insert into Alumno Values(147892,'Norma Rocha','Lic. en Sistemas','05/07/2014','88808592')

Alter Table Alumno
Disable Trigger Ejercicio2

Create Trigger Ejercicio3
On Alumno 
Instead of  insert As
Print 'Se ingreso un Registro'

Insert into Alumno Values(147862,'Laura Delgado','Lic. en Sistemas','05/09/2014','88808592')

Select * from Alumno
