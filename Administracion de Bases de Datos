Create database Tren
Use Tren

Create table Pasajero(
Id_Pasajero Int,
Nombre Varchar (20),
APaterno Varchar (20),
AMaterno Varchar (20),
Email Varchar (60),
FechaNac Datetime,
Telefono Varchar (60),
Id_Pais int
)

/*Ejercicio 2*/
Create clustered index indice_Id_Pasajero
On Pasajero (Id_Pasajero)

/*Ejercicio 3*/
Create NonClustered index indice_APaterno_AMaterno
On Pasajero (APaterno, AMaterno)

/*Ejercicio 4*/
Create NonClustered index indice_Id_Pais
On Pasajero (Id_Pais)

/*Ejercicio 5*/
Create NonClustered index indice_Email
On Pasajero (Email)

/*Ejercicio 6*/
Create NonClustered index indice_FechaNac
On Pasajero (FechaNac)

/*Ejercicio 7*/
Create NonClustered index Indice_APaterno_AMaterno On Pasajero(Nombre)
With drop_existing

/*Ejercicio 8*/
Create Clustered index Indice_Id_Pais On Pasajero(Nombre)
With drop_existing

/*Ejercicio 9*/
Drop Index Pasajero.indice_Email

/*Ejercicio 10*/
SP_Helpindex Pasajero

Practica 4

Create database Empresa
Use Empresa

Create table Venta(
Codigo_Venta int Primary Key,
No_Vendedor int,
Codigo_Producto int,
Fecha Date
)

Insert into Venta Values(1,124,23,'08/23/2015')
Insert into Venta Values(3,643,42,'08/23/2015')
Insert into Venta Values(5,124,23,'08/25/2015')
Insert into Venta Values(6,642,45,'08/25/2015')

Create table Vendedor(
No_Vendedor int Primary Key,
Nombre Varchar (60),
Apellido varchar (40),
Edad int,
Genero varchar (1),
Sueldo Money
)

Insert into Vendedor Values(124,'Gregorio','Arredondo',34,'M','9000')
Insert into Vendedor Values(34,'Alberto','Luna',20,'M','8500')
Insert into Vendedor Values(642,'Julio','Mandujando',45,'M','9500')
Insert into Vendedor Values(145,'Fernando','Cortes',31,'M', '8500')
Insert into Vendedor Values(643,'Veronica','Sepulveda',19,'F','8500')

Create Proc Ejercicio1
As Select Venta.Codigo_Venta,Venta.No_Vendedor,Vendedor.Nombre,Vendedor.Apellido, Vendedor.No_Vendedor from Venta
inner Join Vendedor
On Venta.No_Vendedor = Vendedor.No_Vendedor
Order by Apellido
Execute Ejercicio1

Create Proc Ejercicio2
As Select Venta.Codigo_Venta, Vendedor.Nombre,Vendedor.Apellido, Vendedor.Sueldo From Venta
Inner Join Vendedor
On Venta.No_Vendedor=Vendedor.No_Vendedor
Where Genero ='M'
Execute Ejercicio2

Create Proc Ejercicio3
As Select Venta.Codigo_Venta, Venta.No_Vendedor, Venta.Codigo_Producto, Venta.Fecha, Vendedor.Nombre,Vendedor.Apellido From Venta
Inner Join Vendedor
On Venta.No_Vendedor=Vendedor.No_Vendedor
Where Codigo_Producto between 20 and 40
Execute Ejercicio3

Create Proc Ejercicio4
As Select Nombre,Apellido,sueldo+500 from Vendedor
Where Sueldo = 8500
Execute Ejercicio4

Create Proc Ejercicio5
As Select Genero, AVG (Sueldo) as 'Salaro Promedio' from Vendedor
Group by Genero
Execute Ejercicio5

Alter Proc Ejercicio5
As  Select Genero, AVG (Sueldo) as 'Salaro Promedio' from Vendedor
Where Apellido not like '%s'
Group by Genero
Execute Ejercicio5

Execute Ejercicio5
Execute Ejercicio4
Execute Ejercicio3
Execute Ejercicio2
Execute Ejercicio1

Sp_Helptext Ejercicio5

Drop Proc Ejercicio4

Practica 5

Create Database Empresa
use Empresa

Create table Empleado_Laboral (
No_Empleado int Primary Key,
Especialidad Varchar (60),
Fecha_Alta Date,
Titulo Varchar (2),
Salario Money,
Departamento Varchar (60)
)

Create proc Ejercicio1
@No_Empleado  int,
@Especialidad Varchar (60),
@Fecha_Alta   Date,
@Titulo       Varchar (2),
@Salario      Money,
@Departamento Varchar (50)
As
Insert into Empleado_Laboral (No_Empleado,Especialidad,Fecha_Alta,Titulo,Salario,Departamento)
Values (@No_Empleado,@Especialidad,@Fecha_Alta,@Titulo,@Salario,@Departamento)

Create Proc Ejercicio3
@Especialidad Varchar (60) As
Select No_Empleado, Titulo from Empleado_Laboral
Where Especialidad=@Especialidad
Execute Ejercicio3 'Arquitectura'
